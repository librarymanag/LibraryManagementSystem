<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Library Management System</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: url("https://www.voicesofruralindia.org/wp-content/uploads/2020/11/ylswjsy7stw-scaled.jpg") no-repeat center center/cover;
    }
    h1 {
      text-align: center;
      color: #fff;
      text-shadow: 2px 2px 5px #000;
    }
    .container {
      max-width: 900px;
      margin: auto;
      background: rgba(255,255,255,0.95);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    input, select {
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
    }
    th {
      background: #333;
      color: white;
    }
    button {
      padding: 6px 12px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .issue { background: #28a745; color: white; }
    .return { background: #dc3545; color: white; }
    .addBtn { background: #007bff; color: white; width: 100%; margin-top: 5px; }
    .filterBtn { background: #ff9800; color: white; margin: 5px 0; }
    .logoutBtn { background: #f44336; color: white; margin: 5px 0; float: right; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <h1>Library Management System</h1>
  
  <div class="container" id="authSection">
    <h3>Login</h3>
    <input type="text" id="loginUser" placeholder="Username">
    <input type="password" id="loginPass" placeholder="Password">
    <button onclick="login()">Login</button>
    
    <h3>Create Account</h3>
    <input type="text" id="newUser" placeholder="New Username">
    <input type="password" id="newPass" placeholder="New Password">
    <select id="roleSelect">
      <option value="user">User</option>
      <option value="admin">Admin</option>
    </select>
    <button onclick="createAccount()">Create Account</button>
  </div>

  <div class="container hidden" id="mainSection">
    <button class="logoutBtn" onclick="logout()">Logout</button>
    <p>Welcome, <b id="currentUser"></b> (<span id="currentRole"></span>)</p>
    
    <!-- Search Box -->
    <input type="text" id="searchBox" placeholder="Search book by title..." onkeyup="searchBook()">

    <!-- Add Book Form (Only for Admin) -->
    <div id="adminSection" class="hidden">
      <h3>Add New Book</h3>
      <input type="text" id="newTitle" placeholder="Enter Book Title">
      <input type="text" id="newAuthor" placeholder="Enter Author Name">
      <button class="addBtn" onclick="addBook()">Add Book</button>
    </div>

    <!-- Filter Buttons -->
    <button class="filterBtn" onclick="filterBooks('all')">Show All</button>
    <button class="filterBtn" onclick="filterBooks('available')">Available Books</button>
    <button class="filterBtn" onclick="filterBooks('issued')">Issued Books</button>

    <!-- Book Table -->
    <table id="bookTable">
      <thead>
        <tr>
          <th>Book ID</th>
          <th>Title</th>
          <th>Author</th>
          <th>Status</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="bookList"></tbody>
    </table>
  </div>

  <script>
    let books = [
      {id: 1, title: "JavaScript Basics", author: "John Doe", issued: false},
      {id: 2, title: "HTML & CSS Guide", author: "Jane Smith", issued: false},
      {id: 3, title: "Data Structures", author: "Mark Wilson", issued: false},
      {id: 4, title: "Web Development", author: "Sara Lee", issued: false}
    ];

    let filter = "all";
    let currentUser = null;

    let users = JSON.parse(localStorage.getItem("users")) || [
      {username: "admin", password: "admin", role: "admin"}
    ];

    function displayBooks() {
      let table = document.getElementById("bookList");
      table.innerHTML = "";
      books.forEach((book, index) => {
        if (filter === "available" && book.issued) return;
        if (filter === "issued" && !book.issued) return;
        let row = `
          <tr>
            <td>${book.id}</td>
            <td>${book.title}</td>
            <td>${book.author}</td>
            <td>${book.issued ? "Issued" : "Available"}</td>
            <td>
              ${(currentUser.role === "user" || currentUser.role === "admin") ? 
                `<button class="${book.issued ? 'return' : 'issue'}" onclick="toggleIssue(${index})">
                  ${book.issued ? "Return" : "Issue"}
                </button>` 
              : ""}
            </td>
          </tr>`;
        table.innerHTML += row;
      });
    }

    function addBook() {
      let title = document.getElementById("newTitle").value.trim();
      let author = document.getElementById("newAuthor").value.trim();
      if (title === "" || author === "") {
        alert("Please enter both Title and Author!");
        return;
      }
      let newBook = {
        id: books.length + 1,
        title: title,
        author: author,
        issued: false
      };
      books.push(newBook);
      document.getElementById("newTitle").value = "";
      document.getElementById("newAuthor").value = "";
      displayBooks();
    }

    function toggleIssue(index) {
      books[index].issued = !books[index].issued;
      displayBooks();
    }

    function searchBook() {
      let input = document.getElementById("searchBox").value.toLowerCase();
      let rows = document.querySelectorAll("#bookTable tbody tr");
      rows.forEach(row => {
        let title = row.cells[1].textContent.toLowerCase();
        row.style.display = title.includes(input) ? "" : "none";
      });
    }

    function filterBooks(type) {
      filter = type;
      displayBooks();
    }

    function createAccount() {
      let username = document.getElementById("newUser").value.trim();
      let password = document.getElementById("newPass").value.trim();
      let role = document.getElementById("roleSelect").value;

      if (username === "" || password === "") {
        alert("Please enter Username and Password!");
        return;
      }
      if (users.find(u => u.username === username)) {
        alert("Username already exists!");
        return;
      }
      users.push({username, password, role});
      localStorage.setItem("users", JSON.stringify(users));
      alert("Account created successfully!");
      document.getElementById("newUser").value = "";
      document.getElementById("newPass").value = "";
    }

    function login() {
      let username = document.getElementById("loginUser").value.trim();
      let password = document.getElementById("loginPass").value.trim();
      let user = users.find(u => u.username === username && u.password === password);
      if (user) {
        currentUser = user;
        document.getElementById("authSection").classList.add("hidden");
        document.getElementById("mainSection").classList.remove("hidden");
        document.getElementById("currentUser").textContent = user.username;
        document.getElementById("currentRole").textContent = user.role;
        if (user.role === "admin") {
          document.getElementById("adminSection").classList.remove("hidden");
        }
        displayBooks();
      } else {
        alert("Invalid credentials!");
      }
    }

    function logout() {
      currentUser = null;
      document.getElementById("authSection").classList.remove("hidden");
      document.getElementById("mainSection").classList.add("hidden");
    }
  </script>
</body>

</html>
